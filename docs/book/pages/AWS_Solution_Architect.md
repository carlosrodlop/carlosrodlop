# References

After doing the cource from [Digital Training](https://digitalcloud.training/aws-cheat-sheets/), I reviwed the following resources to make this summary:

* https://codingnconcepts.com/aws/aws-certified-solutions-architect-associate/#aws-infrastructure (2021)
* https://github.com/kasukur/AWS_CCP_Notes/blob/main/AWS_Solution_Architecture_Associate.txt (2021)
* https://chloemcateer.medium.com/aws-solution-architect-associate-exam-study-notes-b6c5884ee500 (2021)

Finally, I practiced the following Exam Tests
# AWS Solution Architect

## Global

### Infrastructure

* [30 Regions with 96 Availability Zones](http://clusterfrak.com/notes/certs/aws_saa_notes/#security-and-identity)
* Edge locations are CDN endpoints for CloudFront. Currently there are over 50 edge locations. Not the same as an AZ
* Maximum Response time for Business is 1 hour
* Services such as CloudFormation, Elastic Beanstalk, Autoscaling, and OpsWorks are free however resources generated by these services are not free

#### AWS Region

* AWS regions are physical locations around the world having cluster of data centers
* You need to select the region first for most of the AWS services such as EC2, ELB, S3, Lambda, etc.
* You can not select region for Global AWS services such as IAM, AWS Organizations, Route 53, CloudFront, WAF, etc.
* Each AWS Region consists of multiple, isolated, and physically separate AZs (Availability Zones) within a geographic area.

#### AWS AZ (Availability zones)

* An AZ is one or more discrete data centers with redundant power, networking, and connectivity
* All AZs in an AWS Region are interconnected with high-bandwidth, low-latency networking.
* Customer deploy applications across multiple AZs in same region for high-availability, scalability, fault-tolerant and low-latency.
* AZs in a region are usually 3, min is 2 and max is 6 for e.g. 3 AZs in Ohio are us-east-2a, us-east-2b, and us-east-2c.
* For high availability in us-east-2 region with min 6 instances required either place 3 instances in each 3 AZs or place 6 instances in each 2 AZs (choose any 2 AZs out of 3) so that it works normal when 1 AZ goes down.

### Tags

* Key/Value pairs attached to AWS resources
* Metadata (data about data).
* Sometimes can be inherited (Auto-scaling, CloudFormation, Elastic Beanstalk can create other resources)
* Resource Groups make it easy to group your resources using the tags that are assigned to them
  * You can group resources that share one or more tags
  * Resource groups contain info such as region, name, health checks

### Amazon Resource Name (ARN)

* Identifier (ID) for any AWS resource. They are globally unique
* begin with `arn:<partition>:<service>:<region>:<account_id>` and end with: resource
resource_type/resource, resource_type/resource/qualifier, resource_type/resource:qualifier, resource_type:resource and resource_type:resource:qualifier
* Examples:
	* `arn:aws:iam::123456789012:user/sri` <-- :: region is omitted because IAM is global
  * `arn:aws:s3:::my_awesome_bucket/image.png` <-- ::: - no region, no account id needed to identify an object in S3. all objects in S3 are globally unique
  * `arn:aws:dynamodb:us-east-1:123456789012:table/orders`
  * `arn:aws:ec2:us-east-1:123456789012:instance/*` - wildcard. EC2 is a regional service

### Consolidated Billing:

* Accounts roll for customers:
  * Paying account is independent, can not access resources of the other accounts
  * Linked accounts are independent from one another
  * Currently there is a limit of 20 linked accounts for consolidated billing (soft limit)
  * One bill per AWS account
  * Easy to track charges and allocate costs between linked accounts
  * Volume pricing discount
  * Resources across all linked accounts are tallied, and billing is applied collectively to allow bigger discounts

### Best Practices:

* Business Benefits of Cloud:
  * Almost 0 upfront infrastructure investment
  * Just in time Infrastructure
  * More efficient resource utilization
  * Usage based costing
  * Reduced time to market

* Technical Benefits of Cloud:
  * Automation - Scriptable infrastructure
  * Auto-Scaling
  * Proactive Scaling
  * More efficient development life cycle
  * Improved testability
  * DR and Business Continuity
  * Overflow the traffic to the cloud

* Design for Failure
  * Rule of thumb: Be a pessimist when designing architectures in the cloud
  * Assume things will fail, always design implement and deploy for automated recovery from failure
  * Assume your hardware will fail
  * Assume outages will occur
  * Assume that some disaster will strike your application
  * Assume that you will be slammed with more than the expected number of requests per second
  * Assume that with time your application software will fail too

* Decouple your components:
  * Think SQS
  * Build components that do not have tight dependencies on each other so that if one component dies, fails, sleeps, or becomes busy, the other components are built so they can continue to work as if no failure is happening. Build each component as a black box

### [Service Quotas](https://docs.aws.amazon.com/general/latest/gr/aws_service_limits.html) (known before as Service Limits)

* Your AWS account has default quotas, formerly referred to as limits, for each AWS service. Unless otherwise noted, each quota is Region-specific. You can request increases for some quotas, and other quotas cannot be increased.

## Security, Identity & Compliance

### IAM (Global Service)

* AWS Identity and Access Management Service (AWS IAM) is used to securely control **individual and group access to AWS resources**.

![IAM](https://d1.awsstatic.com/product-marketing/IAM/iam-how-it-works-diagram.04a2c4e4a1e8848155840676fa97ff2146d19012.png)

* IAM is global (so region isn’t a factor)
* It offers centralized control over your AWS account. It enables shared access to your AWS account.
* Granular Permissions (can set different permissions for different people/ different resources)
* Includes Federation Integration which taps into Active Directory, Facebook, Linkedin, etc. for authentication
* Multi-factor authentication support
* Allows configuration of temporary access for users, devices and services
* It supports PCI DSS compliance. PCI DSS compliance just is basically a compliant framework that if you're taking credit card details, you need to be compliant with the framework. So IAM supports PCI DSS.
* Access entities:
  * `Users` End users such as people, employees of an organisation ... etc
    * IAM users are individuals who have been granted access to an AWS account.
    * New Users
      * They have NO permissions when first created, NO have access to any AWS services (they can only login to the AWS console) ==> Permission must be explicitly granted to allow a user to access an AWS service.
      * They are assigned Access Key ID & Secret Access Keys when first created => You can get to view these once. If you lose them, you have to regenerate them.
      * In order for a new IAM user to be able to log into the console, the user must have a password set
  * `Groups` are a collection of users, and can not have other groups. Groups allow you to define permissions for all the users within it.
  * `Roles` Assigned to AWS resources, specifying what the resource (such as EC2) is allowed to access on another resource (S3)
    * Adventanges
      * Roles are more secure than storing your access key and secret access key on individual EC2 instances.
      * Roles are easier to manage.
      * Roles can be assigned to an EC2 instance after it is created using both the console & command line.
    * Types of Roles
      * Service Roles (To assign permission to AWS Resources)
      * Cross account access roles: Used when you have multiple AWS accounts and another AWS account must interact with the current AWS account
      * Identity provider access roles : Identity Federation (including AD, Facebook etc) can be configured to allow secure access to resources in an AWS account without creating an IAM user account.

* `Policies` JSON Document that defines permissions (`Allow` or `Deny` access to an action that can be performed on AWS resources) for Access Entities (user, group or role)
    * Each statement matches an AWS API request
    * Anything that is not explicitly allowed is implicitly denied
      * **IAM Policy Evaluation Logic** ➔ Explicit Deny ➯ Organization SCPs ➯ Resource-based Policies (optional) ➯ IAM Permission Boundaries ➯ Identity-based Policies
    * If a resource has multiple policies — AWS joins them
    * The **Least Privilege Principle** should be followed in AWS, don’t give more permission than a user needs.
    * **IAM Permission Boundaries** to set at individual user or role for maximum allowed permissions
    * **Resource Based Policies** are supported by S3, SNS, and SQS.
    * Sections:
      * `Version` policy language version. `2012-10-17` is the latest version.
      * `Statement` container for one or more policy statements
      * `Sid` (optional) a way of labeling your policy statement
      * `Effect` set whether the policy Allows or Deny
      * `Principal` user, group, role, or federated user to which you would like to allow or deny access
      * `Action` one or more actions that can be performed on AWS resources
      * `Resource` one or more AWS resources to which actions apply
      * `Condition` (optional) one or more conditions to satisfy for policy to be applicable, otherwise ignore the policy.

```json
{
    "Version":"2012-10-17",
    "Statement":[{
        "Sid": "Deny-Barclay-S3-Access",
        "Effect":"Deny",
        "Principal": { "AWS": ["arn:aws:iam:123456789012:barclay"] },
        "Action": [ "s3:GetObject", "s3:PutObject", "s3:List*" ],
        "Resource": ["arn:aws:s3:::mybucket/*"]
    },{
        "Effect": "Allow",
        "Action": "iam:CreateServiceLinkedRole",
        "Resource": "*",
        "Condition": {
            "StringLike": {
                "iam:AWSServiceName": [
                    "rds.amazonaws.com",
                    "rds.application-autoscaling.amazonaws.com"
                ]
            }
        }
    }]
}
```

* `Root account` is created by default with full administrator. Root account is email address that you used to register your account
  * Best practices
    * Not to use the root account for anything other than billing (not login)
    * Always setup Multifactor Authentication on your root account.
* `Power user access` → Access to all AWS services except the management of groups and users within IAM

### Access AWS

#### IAM Users

* Options:
  * AWS Management Console - Use password + MFA (multi factor authentication)
  * AWS CLI or SDK - Use Access Key ID (~username) and Secret Access Key (~password)
  * AWS CloudShell - CLI tool from AWS browser console - Require login to AWS

* Temporary security credentials consist of the AWS access key ID, secret access key, and security token.
    * IAM can assign temporary security credentials to provide users with temporary access to services/resources.

* When creating a user's credentials, you can only see/download the credentials at the time of creation not after.
* Access Keys can be retired, and new ones can be created in the event that secret access keys are lost
* To create a user password, once the users have been created, choose the user you want to set the password for and from the User Actions drop list, click manage password. Here you can opt to create a generated or custom password. If generated, there is an option to force the user to set a custom password on next login. Once a generated password has been issued, you can see the password which is the same as the access keys. Its shown once only

#### None IAM Users

* Non-IAM user first authenticates from Identity Federation ==> Then provide a temporary token (IAM Role attached) generated by calling a AssumeRole API of `STS (Security Token Service)` ==> Non-IAM user access the AWS resource by **assuming IAM Role attached with token**.

##### Identity Federation

* SAML 2.0 (old) to integrate Active Directory/ADFS, use AssumeRoleWithSAML STS API
* Custom Identity Broker used when identity provider is not compatible to SAML 2.0, use AssumeRole or GetFederationToken STS API
* Web Identity Federation is used to sign in using well-known external identity provider (IdP), such as login with Amazon, Facebook, Google, or any OpenID Connect (OIDC)-compatible IdP. Get the ID token from IdP, use AWS Cognito api to exchange ID token with cognito token, use AssumeRoleWithWebIdentity STS API to get temp security credential to access AWS resources
* AWS Cognito (`Amazon Cognito Federated Identities`) is recommended identity provider by Amazon
* Amazon Single Sign On gives single sign on token to access AWS, no need to call STS API

##### AWS Directory Service

* Directories store information about users, groups, and devices, and administrators use them to manage access to information and resources. Hierarchical database of users, groups, computers - trees and forests.

###### Compatible with Microsft Active Directory

* `Managed Microsoft Active Directory`
  * It is managed Microsoft Windows Server AD with trust connection to on-premise Microsoft AD.
  * Best choice when you need all AD features to support AWS applications or Windows workloads.
  * Easily migrate on-premise workloads as it is built on actual Microsoft AD, so does not require any replication of existing directory to the cloud.
  * Highly available as directories are deployed across multiple Availability Zones and failovers are detected automatically.
  * A common use case would be to extend your on-premise using AD Trust with AWS Managed Microsoft AD so that both your on-premises and cloud directories remain separated, but it allows your users access AWS as needed.

* `Simple AD`
  * Use Simple AD  is standalone AWS managed compatible AD powered by Samba 4 with basic directory features (Enables a subset of the features Managed Mircosoft AD)
  * You cannot connect it to on-premise AD.
  * Best choice for basic directory features.
  * Can be used for Linux workloads that need LDAP

* `AD Connector`
  * It is proxy service to redirect requests to on-premise Microsoft AD, without caching information in the cloud.
  * Best choice to use existing on-premise AD with compatible AWS services.
  * Can use multiple AD Connectors to spread the load to match performance needs
  * Cannot be used across different AWS accounts

###### No Compatible with Microsft Active Directory

* `Cloud Directory`
  * Cloud-native directories for organizing Hierarchies of data along **multiple dimensions** fully managed by AWS
  * Can have multiple hierarchies with hundreds/millions of objects
  * Some common use cases include: directories for organisational charts, course catalogs, and device registries.

* `Amazon Cognito`
  * It control uses authentication (sign-up and sign-in) + access (premissions) for **mobile and web applications**. Supports guest users.
  * The two main components of Amazon Cognito are:

a. `User pools`: User directories in Amazon Cognito. Options for authetication
      * Directly through Amazon Cognito.
      * Through social identity providers like Google, Facebook, Amazon, or Apple, and through SAML identity providers.

  In any case, menber of the user pool have a directory profile that you can access through a Software Development Kit (SDK)

![Amazon Cognito, User pools](https://docs.aws.amazon.com/images/cognito/latest/developerguide/images/scenario-authentication-cup.png)

b. `Identity pools`: Cognito elements grant users temporary credentials to other AWS services (e.g., Amazon S3 and DynamoDB).

Steps: You first authenticate user using `Cognito User Pools` and then exchange token with `Cognito Identity Pools` which further use `AWS STS` to generate temporary AWS credentials to access AWS Resources.
  * AWS Security Token Service (AWS STS) as a web service that enables you to request temporary, limited-privilege credentials for AWS Identity and Access Management (IAM) users or for users you authenticate (federated users)

### AWS Key Management Service (KMS)

* AWS managed centralized key management service to create, manage and rotate customer master keys (CMKs) for encryption at REST. Provides you with a central place to manage all keys.
* Can integrate with most other AWS services to increase security and make it easier to encrypt your data.

![AWS Key Management Service (KMS)](https://d1.awsstatic.com/Security/aws-kms/Group%2017aws-kms.6dc3dbbbe5b75b46c4f62218d0531e5bed7276ce.png)

* You can enable automatic master key rotation once per year. Service keeps the older version of master key to decrypt old encrypted data.
* Allows you to control access to the keys using things like IAM policies or key policies.
* Encrypt/decrypt up to 4KB.
* Pay per API call.
* Validated under FIPS 140–2 (**Level 2**) security standard.
* Types of Customer Master Keys (CMKs)
  * `Customer Managed CMKs` (Dedicated to my account) → Keys that you have created in AWS, that you own and manage. You are responsible for managing their key policies, rotating them and enabling/disabling them.
    * You can create customer-managed `Symmetric` (single key for both encrypt and decrypt operations) or `Asymmetric` (public/private key pair for encrypt/decrypt or sign/verify operations) master keys
    * Symmetric CMKs
      * With symmetric keys, the same key is used to encrypt and decrypt
      * The key never leaves AWS unencrypted
      * Must call the KMS API to use a symmetric key
      * The AWS services that integrate with KMS use symmetric CMKs
    * Asymmetric CMKs
      * Asymmetric keys are mathematically related public and private key pairs.
      * The private key never leaves AWS unencrypted.
      * You can call the KMS API with the public key, which can be downloaded and used outside of AWS.
      * AWS services that integrate with KMS DO NOT support asymmetric keys.
  * `AWS Managed CMKs` (Dedicated to my account) → These are free and are created by an AWS service on your behalf and are managed for you. However, only that service can use them. Used by default if you pick encryption in most AWS services
  * `AWS Owned CMKs` (No Dedicated to my account) → owned and managed by AWS and shared across many accounts.

### AWS CloudHSM

* Dedicated cloud-based Hardware Security Module (HSM) for creating, using and managing your own encryption keys (cryptographic keys) in AWS.
* Conforms to FIPS 140–2 (**Level 3**) security standard
* No access to the AWS managed component and AWS does not have visibility or access to your keys.
* Integrate with your application using industry-standard APIs (No AWS APIs), such as PKCS#11, Java Cryptography Extensions (JCE), and Microsoft CryptoNG (CNG) libraries (there are no AWS APIs for HSM)
* CloudHSM runs within a VPC in your account
  *  CloudHSM will operate inside its own VPC dedicated to CloudHSM
  *  CloudHSM will project to ENI of customer VPC
* Keys are irretrievable if lost and can not be recovered.

![AWS CloudHSM](https://d1.awsstatic.com/whiteboard-graphics/products/CloudHSM/product-page-diagram_AWS-CloudHSM_HIW.76ce14889e22d8861a6a9fff0b5664516ed1bddd.png)

* Use case: Use KMS to create a CMKs in a custom key store and store non-extractable key material in AWS CloudHSM to get a full control on encryption keys
* Difference between KMS and CloudHSM
  * FIPS 140–2 Level 2 vs Level 3
  * We manage our keys
	* KMS (Multi Tenant) and CloudHSM (Single Tenant, dedicate h/w, Mutli-AZ cluster)

### AWS Systems Manager

* `Parameter Store` is Secure and centralized serverless storage of configuration and secrets: passwords, database details, and license code, API Keys
    * `Parameter` value can be type String (plain text), StringList (comma separated) or SecureString (KMS encrypted data)
    * `Use case`: Centralized configuration for dev/uat/prod environment to be used by CLI, SDK, and Lambda function
* `Run Command` allows you to automate common administrative tasks and perform one-time configuration changes on EC2 instances at scale
* `Session Manager` replaces the need for Bastions to access instances in private subnet

### AWS Secrets Manager

* Secret Manager is mainly used to store, manage, and rotate secrets (passwords) such as database credentials, API keys, and OAuth tokens.
* Apply the new key/passwords in RDS for you. Generate random secrets.
* Secret Manager has **native support to rotate database credentials of RDS databases** - MySQL, PostgreSQL and Amazon Aurora. Automatically rotate secrets.
* For other secrets such as API keys or tokens, you need to use the **lambda for customized rotation function**.

### AWS Shield

* AWS managed **Distributed Denial of Service (DDoS) protection service**.
* Protect against **Layer 3 and 4** (Network and Transport) attacks.
* `AWS Shield Standard` is automatic and free DDoS protection service for all AWS customers for CloudFront and Route 53 resources.
* `AWS Shield Advanced` is paid service (Advanced costs $3K per month per org) for enhanced DDoS protection for EC2, ELB, CloudFront, and Route 53 resources.

### AWS WAF

* **Web Application Firewall** add an extra layer of protection to your web applications or APIs against web attacks from common exploits, such as SQL injection or Cross-site scripting (XSS).
* You can deploy WAF on CloudFront, Application Load Balancer, API Gateway and AWS AppSync
* Protect against **Layer 7** (HTTP & HTTPS) attacks and block common attack patterns by setting up rules to control the traffic. How?
  * Setting up your own rules to control the traffic by either only allowing what you specify or only blocking what you specify. Alternatively, you can count the requests that match a certain pattern.
  * AWS also provides managed rules that you can use to get started quickly, these are fully pre-configured and cover things like the OWASP Top 10 Security risks.
  * Conditions are used in WAFs to specify when you want to allow/block requests. Below are some examples of conditions that you might:
    * Values on the request header
    * The country a request comes from
    * Specific IP addresses
    * Strings that appear in requests
    * Length of the request
    * Presence of SQL code
    * Presence of a script
* Pay for what you use, based on the number of rules you have and requests your applications receive.

![AWS WAF](https://d1.awsstatic.com/Product-Page-Diagram_AWS-Web-Application-Firewall%402x.5f24d1b519ed1a88b7278c5d4cf7e4eeaf9b75cf.png)

### AWS Firewall Manager

* Use AWS Firewall Manager to centrally configure and manage Firewall Rules across an Organization: AWS WAF rules, AWS Shield Advanced, Network Firewall rules, and Route 53 DNS Firewall Rules
* Use case: Meet Gov regulations to deploy AWS WAF rule to block traffic from embargoed countries across accounts and resources

![](https://d1.awsstatic.com/products/firewall-manager/product-page-diagram_AWS-Firewall-Manager%402x%20(1)1.ad6bf5281dc2c33c0493e9988e3504dd1590eaa2.png)

### AWS GuardDuty

* Read VPC Flow Logs, DNS Logs, and CloudTrail events. Apply machine learning algorithms and anomaly detections to discover threats
* Can protect against CryptoCurrency attacks

![AWS GuardDuty](https://d1.awsstatic.com/Security/Amazon-GuardDuty/Amazon-GuardDuty_HIW.057a144483974cb73ab5f3f87a50c7c79f6521fb.png)

### Amazon Inspector

* Automated Security Assessment service for **EC2 instances** by installing an agent in the OS of EC2 instance.
* Inspector comes with pre-defined rules packages:
  * `Network Reachability` rules package checks for unintended network accessibility of EC2 instances
  * `Host Assessment rules` package checks for vulnerabilities and insecure configurations on EC2 instance. Includes Common Vulnerabilities and Exposures (CVE), Center for Internet Security (CIS) Operating System configuration benchmarks, and security best practices.

### Amazon Macie

* Managed service to discover and protect your **sensitive data** in AWS
* Can automatically discover **Personally Identifiable Information (PII)**  in your data and can alert you once identified (e.g. selected S3 buckets)
* Can produce dashboards, reporting and alerts
* Benefits of Macie
  * Cost efficiently discovers sensitive data at scale
  * Constant visibility of data security/privacy through alerts and dashboards
  * Can use used across AWS accounts through AWS Organisations.
  * Can help you meet regulatory compliance
  * Great for PCI-DSS(credit card payments) and preventing theft

![Amazon Macie](https://d1.awsstatic.com/reInvent/reinvent-2022/macie/Product-Page-Diagram_Amazon-Macie.a51550cca0a731ba2e4a26e8463ed5f5a81202e3.png)

### AWS Config

* Managed service that provides you with an AWS resource inventory, configuration history, and configuration change notifications to enable security and governance. Assess, audit, and evaluate configurations of your AWS resources in multi-region, multi-account
* You are notified via SNS for any configuration change
* Integrated with CloudTrail, provide resource configuration history
* Use case: Customers need to comply with standards like PCI-DSS (Payment Card Industry Data Security Standard) or HIPAA (U.S. Health Insurance Portability and Accountability Act) can use this service to assess compliance of AWS infra configurations

## Compute

### EC2

* Infrastructure as a Service (IaaS) - Re-sizable (elastic) and secure virtual machine on the cloud.
  * Amazon EC2 reduces the time required to obtain and boot new server instances to minutes, allowing you to quickly scale capacity, both up and down, as your computing requirements change.
  * Gives you complete control of your computing resources including choice of storage, processor, networking and operating system.
* When you restart an EC2 instance, its public IP can change. Use `Elastic IP` to assign a fixed public IPv4 to your EC2 instance. By default, all AWS accounts are limited to five (5) Elastic IP addresses per Region.
* You need to create a key pair — public & private for asymmetric encryption.
* The EC2 Root volume is a virtual disk where the OS is installed, it can only be launched on SSD or Magnetic.
* Bootstrap scripts are code that gets ran as soon as your EC2 instance first boots up.
* EC2 Information Endpoints (can be obteined via `curl`):
  * `http://169.254.169.254/latest/meta-data` ==> Metadata Private & public IP
  * `http://169.254.169.254/latest/user-data` ==> user-defined data
* Use VM Import/Export to import virtual machine image and convert to Amazon EC2 AMI to launch EC2 instances
* Exams tips:
  * Termination protection is turned off by default, you must turn it on.
  * On an EBS-backed instance, the default action is for the root EBS volume to be deleted when the instance is terminated. Any additional EBS volumes by default won't be deleted.
  * Root device volumes can be encrypted now (a popular exam topic)
  * EBS Root volumes of your DEFAULT AMI's CAN be encrypted. You can also use a third party tool (such as bit locker etc) to encrypt the root volume, or this can be done when creating AMI's (lab to follow) in the AWS console or using the API.
  * Additional volumes can be encrypted as well.
  * You must provision nitro-based EC2 instance to achieve 64000 EBS IOPS. Max 32000 EBS IOPS with Non-Nitro EC2.
  * EC2 Design
    * Place all the EC2 instances in same AZ to reduce the data transfer cost.
    * Design for failure. Have one EC2 instance in each availability zone.

#### EC2 Hibernate

* Allows you to hibernate your EC2 instances, so that you can stop them and pick back up where you left off again.
* It does this by saving the content from the in-memory state of the instance (RAM) to your EBS root volume.
* You can hibernate an instance only if it’s enabled for hibernation and it meets the hibernation prerequisites
* Useful for long running services and services that take long to boot.
* Can’t hibernate for more than 60 days
* Once in hibernation mode there is no hourly charge — you only pay for the elastic IP Address & other attached volumes
* Boots up a lot faster after hibernation as it does not need to reload the operating system.
#### EC2 Instance Types

You can choose EC2 instance type based on requirement for e.g. m5.2xlarge has Linux OS, 8 vCPU, 32GB RAM, EBS-Only Storage, Up to 10 Gbps Network bandwidth, Up to 4,750 Mbps IO Operations.

| Instance Class 	| Usage Type  |  Usage Example 	|
|---	|---	|---	|
|  T, M | General Purpose |  Web Server, Code Repo, Microservice, Small Database, Virtual Desktop, Dev Environment 	|
|  C 	| Compute Optimized  |  High Performance Computing (HPC), Batch Processing, Gaming Server, Scientific Modelling, CPU-based machine learning 	|
|  R, X, Z 	| Memory Optimized  |  In-memory Cache, High Performance Database, Real-time big data analytics	|
|  F, G, P 	| Accelerated Computing  |  High GPU, Graphics Intensive Applications, Machine Learning, Speech Recognition	|
|  D, H, I	| Storage Optimized  |  EC2 Instance Storage, High I/O Performance, HDFS, MapReduce File Systems, Spark, Hadoop, Redshift, Kafka, Elastic Search |

####  EC2 Pricing Types

* **On-Demand** - Pay a fixed rate by the hour (or by the second) with no commitment. Pay as you use, costly
  * Use Cases:
    1. Users that want the low cost and flexibility of Amazon EC2 without any up-front payment for long-term commitment.
    2.  Applications with short term, spiky or unpredictable workloads that cannot be interrupted
    3.  Applications being developed or tested on Amazon EC2 for the first time.
* **Reserved** - Provides you with a capacity reservation, and offer significant discount on the hourly charge for an instance, but it requires to have a Contracts for 1 - 3 year terms. Higher discount with upfront payments and longer contracts. However, you cant move between regions.
  * Uses Cases:
    1. Applications with steady or predictable usage.
    2. Applications that require reserved capacity.
    3. Users able to make upfront payments to reduce their total computing costs even further.
  * Types:
    * **Standard Reserved Instances**  Provides the most discount (up to 75% off). Unused instanced can be sold in AWS reserved instance marketplace
    * **Convertible Reserved Instances** up to 54% off. It can be exchanged for another Convertible Reserved Instance with different instance attributes e.g. you to change between instance types e.g. t1-t4 as long as its of greater or equal value
    * **Scheduled Reserved Instances** - reserve capacity that is scheduled to recur daily, weekly, or monthly, with a specified start time and duration, for a one-year term.
* **Spot Instances** -  Enables you to bid whatever price you want for instance capacity. when AWS has excess capacity it drops the price so people can use that capacity —but they can take it back at any time. You can set the price you are willing to pay and it will run when its below or at that price — if it goes above that price you lose it.
  * It provides up to 90% discount and typically used for apps with flexible start/end times, But don’t use for anything critical that needs to be online all the time. It can handle interruptions and recover gracefully.
  * Imp Note: If the spot instance is terminated by Amazon EC2, you will not be charged for a partial hour of usage. However, if you terminate the instance yourself, you will be charged for any hour in which the instance ran.
  * Uses Cases
    1. Applications that have flexible start and end times.
    2. Applications that are only feasible at very low compute prices.
    3. Users with urgent computing needs for large amounts of additional capacity.
  * Types
    * **Spot Blocks** can also be launched with a required duration, which are not interrupted due to changes in the Spot price.
    * **Spot Fleet**
      * Collection of spot instances and optionally on-demand instances. Attempts to launch a number of them together to meet a certain capacity within your price budget.
      * The allocation of spot instances depends on how they fulfil your spot fleet request from the possible pool of instances.
      * Strategies:
        * Lowest Price → This is the default strategy. Chooses the fleet pool with the lowest price.
        * Diversified → Distributed across all pools.
        * Capacity Optimised → Pool for optimal capacity for the number of instances launching.
        * InstancePoolsToUseCount → Distributed across the number of pools you specify — this can only be used with the lowest price option.

* **Dedicated Instance** - Your instance runs on a dedicated hardware provide physical isolation, single-tenant
* **Dedicated Hosts** - Your instances run on a dedicated physical server. More visibility how instances are placed on server. Dedicated Hosts can help reduce costs by letting you use existing server-bound software licenses and address corporate compliance and regulatory requirements.
  * Uses Cases
    1. Useful for regulatory requirements that may not support multi-tenant virtualisation.
		1. Great for licensing which doesn't support multi-tenancy or cloud.
		2. Can be purchased On-Demand (hourly)
		3. Can be purchased as a Reservation for up to 70% off the On-Demand price.

#### Security Groups

* A security group acts as a virtual firewall for your EC2 instances to control incoming and outgoing traffic.
* If you don't sepcify a Securtiy Group, the EC2 instance is linked to the default Security Group
* Changes to Security Groups take effect immediately.
* When you create a New Security Group
  * All inbound traffic is blocked by default - so we enable some IP and ports using Security Groups.
    * To let All IPs in `0.0.0.0/0`. To let a single IP address in `X.X.X.X/32` (32 means this ip address)
    * Common Ports: Linux (port 22)
  * All outbound traffic is allowed.
    * Common Ports: Microsoft - RDP (port 3389), HTTP (80) and HTTPS (443)
* Changes to a security groups rules take effect immediately and are automatically applied to all instances associated with that group.
* Cardinality Security Group * - * EC2 Instance
  * You can have any number of EC2 instances within a security group.
  * You can have multiple Security Groups attached/assigned to EC2 instances.
* Security Groups vs ACL
  * Security Groups are STATEFUL, when you create an inbound rule and an outbound rule is automatically created. However, NACL's are STATELESS, when you create an inbound rule and an outbound rule is not automatically created.
  * Security Groups are only permisse, you can specify allows rule, but not deny rules. You CANNOT block specific IP's/Port's using Security Groups instead use Network Access Control Lists.
####  EC2 Enhanced Networking

* Elastic Network Interface (ENI) is a virtual network card, which you attach to EC2 instance in same AZ. ENI has one primary private IPv4, one or more secondary private IPv4, one Elastic IP per private IPv4, one public IPv4, one or more IPv6, one or more security groups, a MAC address and a source/destination check flag
  * While primary ENI cannot be detached from an EC2 instance, A secondary ENI with private IPv4 can be detached and attached to standby EC2 instance if primary EC2 becomes unreachable (failover)
* Elastic Network Adapter (ENA) for C4, D2, and M4 EC2 instances, Upto 100 Gbps network speed.
* Elastic Fabric Adapter (EFA) is ENA with additional OS-bypass functionality, which enables HPC and Machine Learning applications to bypass the operating system kernel and communicate directly with EFA device resulting in very high performance and low latency. for M5, C5, R5, I3, G4, metal EC2 instances.
* Intel 82599 Virtual Function (VF) Interface for C3, C4, D2, I2, M4, and R3 EC2 instances, Upto 10 Gbps network speed.

#### EC2 Placement Groups Strategy

* A way of placing EC2 Instances so that instances are spread across the underlying hardware to minimise failures.
* Placement group names need to be unique within your account
* Only certain instances can be launched in placement groups e.g compute optimised, CPU, memory optimised & storage optimised.
* You can’t merge placement groups, but you can move an existing instance into a placement group.
* There is no charge associated with creating placement groups

* **Cluster** - Grouping instances close together within a single Availability Zone, Same Rack. It is used to achieve low Network latency & high throughput, High Performance Computing (HPC). Recommended you have the same type on instances in the cluster.
* **Spread** - Opposite to clustered placement group. Instance are placed o Different AZ, Distinct Rack. It used for Critical Applications that requires to be seperated on each other to ensure High Availability in case of failure. Spread placement groups can span multiple Availability Zones.
* **Partition** - EC2 creates partitions by dividing each group into logical segments. Each partition has its own set of racks, network and power source to help isolate the impact of a hardware failure. Same or Different AZ, Different Rack (or Partition), Distributed Applications like Hadoop, Cassandra, Kafka etc
#### AMI (Amazon Machine Image)

* Customized image of an EC2 instance, having built-in OS, softwares, configurations, etc.
* You can create an AMI from EC2 instance and launch a new EC2 instance from AMI.
* AMI are built for a specific region and can be copied across regions

## Elastic Load Balancing (ELB)

* Designed to help balance the load of incoming traffic by distributing it across multiple targets/destinations.
  * Target group (ALB o CLB) can have one or more EC2 instances, IP Addresses, lambda functions.
* It makes the traffic Scale and Fault Tolerant (It can balance load across one or more Availability Zones)
* Internal Load Balancers are load balancers that are inside private subnets
* Load Balancers have their own static DNS name (e.g. http://myalb-123456789.us-east-1.elb.amazonaws.com) — you will NEVER be given an IP address
* If you need the IPv4 address of your end user, look for the `X-Forwarded-For` header.
* `Health Checks`
  * Instances monitored by ELB are reported as; InService, or OutofService
  * Health Checks check the instance health by talking to it.
  * `504 Error` means that the gateway has timed out. This means that the application not responding within the idle timeout period.
* Advanced Load Balancers Theory
  * `Stickiness` (a.k.a. Session Affinity):
    * Allows you to bind a users session to a specific instance, ensuring all requests in that specific session are sent to the same instance.
    * Use Cases:
      * A user trying to visit a website behind a classic load balancer and essentially what's happening is it's just sending all the traffic to one EC2 instance. Answer: Disable Sticky session.
      * If you have got an EC2 instance or an application, where you're writing to an EC2 instance like local disk, then of course you would want to enable Sticky.
    * It works in CLB and ALB. (It doesn’t work with NLB)
  * `Cross Zone load Balancing`
    * It enables EC2 instances to get equal share of traffic/load across multiple AZs
    * Use Cases:
      *
  * `Path Patterns` → can direct traffic to different EC2 instances based on request URL.

* Types of ELB

| Type 	| Protocol | OSI Layer |
|---	|---	|--- |
Application Load Balancer	| HTTP, HTTPS, WebSocket | Layer 7 (Application layer) |
Network Load Balancer	| TCP, UDP, TLS | Layer 4 (Transport layer) |
Gateway Load Balancer |	Thirdparty appliances, virtual applications e.g. firewalls| Layer 3 |
Classic Load Balancer (old)	| HTTP, HTTPS, TCP | Both Layer 7 and Layer 4 |

#### Application Load Balancer (ALB)

* Best suitable for protocol HTTP, HTTPS, WebSocket | Layer 7 (Application layer)
* Routes traffic based on request content (hostname, request path, params, headers, source IP etc.).
* Use Case: It is **Intelligent** and can send specific requests to specific servers.

![Application Load Balancer](https://d1.awsstatic.com/Digital%20Marketing/House/1up/products/elb/Product-Page-Diagram_Elastic-Load-Balancing_ALB_HIW%402x.cb3ce6cfd5dd549c99645ed51eef9e8be8a27aa3.png)

#### Network Load Balancer (NLB)

* Best suitable for protocol TCP, UDP, TLS | Layer 4 (Transport layer)
* Use case: when extreme performance is required: Handle **volatile workloads** and **extreme low-latency**. Static IP Address.

![Network Load Balancer](https://d1.awsstatic.com/Digital%20Marketing/House/1up/products/elb/Product-Page-Diagram_Elastic-Load-Balancing_NLB_HIW%402x.2f8ded8b565042980c4ad5f8ec57d6b2fafe54ba.png)

#### Gateway Load Balancer (GLB)

* Thirdparty appliances, virtual applications e.g. firewalls | Layer 3
* Automatically scales virtual appliances based on demand.

#### Classic Load Balancers (Previos Generation)

* It can operate at both Layer 7 (Application layer) and Layer 4 (Transport layer).
* Use Case: Test & Dev to keep costs low.
* It is not very intelligent — it can’t route traffic based on content like Application Load Balancers.

## ASG (Auto Scaling Group)

* Scale-out (add) or scale-in (remove) EC2 instances based on scaling policy - CPU, Network, Custom metric or Scheduled.
* You configure the size of your Auto Scaling group by setting the minimum, maximum, and desired capacity. ASG run EC2 instances at desired capacity if no policy specified. Minimum and maximum capacity are boundaries within ASG scale-in or scale-out. min <= desired <= max
* Instances are created in ASG using Launch Configuration (legacy) or Launch Template (newer)
* You cannot change the launch configuration for an ASG, you must create a new launch configuration and update your ASG with it.
* You can create ASG that launches both Spot and On-Demand Instances or multiple instance types using launch template, not possible with launch configuration.
* Dynamic Scaling Policy
  1. Target Tracking Scaling - can have more than one policy for e.g. add or remove capacity to keep the average aggregate CPU utilization of your Auto Scaling group at 40% and request count per target of your ALB target group at 1000 for your ASG. If both policy occurs at same time, use largest capacity for both scale-out and scale-in.
  2. Simple Scaling - e.g. CloudWatch alarm CPUUtilization (>80%) - add 2 instances
  3. Step Scaling - e.g. CloudWatch alarm CPUUtilization (60%-80%)- add 1, (>80%) - add 3 more, (30%-40%) - remove 1, (<30%) - remove 2 more
  4. Scheduled Action - e.g. Increase min capacity to 10 at 5pm on Fridays
* **Default Termination Policy** - Find AZ with most number of instances, and delete the one with oldest launch configuration, in case of tie, the one closest to next billing hour
* **Cooldown period** is the amount of time to wait for previous scaling activity to take effect. Any scaling activity during cooldown period is ignored.
* **Health check grace period** is the amount of wait time to check the health status of EC2 instance, which has just came into service to give enough time to warmup.
* You can add lifecycle-hooks to ASG to perform custom action during:-
  1. scale-out to run script, install softwares and send complete-lifecycle-action command to continue
  2. scale-in e.g. download logs, take snapshot before termination

### Lambda

## AWS Organization and Control Tower


## VPC


## S3


## DNS, Catching and Performance

## Block and File Storage

## Docker Container and ECS

## Serveless Applications


## Databases y Analytics

## Deployment and Management

## Monitoring, Loggin and Auditing

## Security in the Cloud

## Migration and Trasnfer

## Web, Mobile, ML and Cost Managemnt
